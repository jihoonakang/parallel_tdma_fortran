<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>tdma_fortran: tdma_parallel Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">tdma_fortran
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">tdma_parallel Module Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Parallel tri-diagonal matrix solver using cyclic reduction (CR), parallel CR (PCR), and Thomas+PCR hybrid algorithm.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a7aa2a590feb83632170b7cb7b74fefd3"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetdma__parallel.html#a7aa2a590feb83632170b7cb7b74fefd3">tdma_setup</a> (n, np_world, rank_world)</td></tr>
<tr class="memdesc:a7aa2a590feb83632170b7cb7b74fefd3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize local private variables from global input parameters.  <a href="#a7aa2a590feb83632170b7cb7b74fefd3">More...</a><br /></td></tr>
<tr class="separator:a7aa2a590feb83632170b7cb7b74fefd3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abfb0b9e0d8e67acbd6d8cfa390faee6a"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetdma__parallel.html#abfb0b9e0d8e67acbd6d8cfa390faee6a">cr_solver</a> (a_mpi, b_mpi, c_mpi, r_mpi, x_mpi)</td></tr>
<tr class="memdesc:abfb0b9e0d8e67acbd6d8cfa390faee6a"><td class="mdescLeft">&#160;</td><td class="mdescRight">CR solver: cr_forward_multiple + cr_forward_single + cr_backward_single + cr_backward_multiple.  <a href="#abfb0b9e0d8e67acbd6d8cfa390faee6a">More...</a><br /></td></tr>
<tr class="separator:abfb0b9e0d8e67acbd6d8cfa390faee6a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b221ee60f9b10b484cd5439f5b485f0"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetdma__parallel.html#a5b221ee60f9b10b484cd5439f5b485f0">cr_pcr_solver</a> (a_mpi, b_mpi, c_mpi, r_mpi, x_mpi)</td></tr>
<tr class="memdesc:a5b221ee60f9b10b484cd5439f5b485f0"><td class="mdescLeft">&#160;</td><td class="mdescRight">CR-PCR solver: cr_forward_multiple + pcr_forward_single + cr_backward_multiple.  <a href="#a5b221ee60f9b10b484cd5439f5b485f0">More...</a><br /></td></tr>
<tr class="separator:a5b221ee60f9b10b484cd5439f5b485f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03041ff2dce526db1fed51ab87b84da5"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetdma__parallel.html#a03041ff2dce526db1fed51ab87b84da5">thomas_pcr_solver</a> (a_mpi, b_mpi, c_mpi, r_mpi, x_mpi)</td></tr>
<tr class="memdesc:a03041ff2dce526db1fed51ab87b84da5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Thomas-PCR solver: pThomas_forward_multiple + pcr_forward_double + pThomas_backward_multiple.  <a href="#a03041ff2dce526db1fed51ab87b84da5">More...</a><br /></td></tr>
<tr class="separator:a03041ff2dce526db1fed51ab87b84da5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc500f1450d23091f136330208ca4519"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetdma__parallel.html#afc500f1450d23091f136330208ca4519">cr_forward_multiple_row</a></td></tr>
<tr class="memdesc:afc500f1450d23091f136330208ca4519"><td class="mdescLeft">&#160;</td><td class="mdescRight">Forward elimination of CR until a single row per MPI process remains.  <a href="#afc500f1450d23091f136330208ca4519">More...</a><br /></td></tr>
<tr class="separator:afc500f1450d23091f136330208ca4519"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9df427633cb9dc93aae24114abf95d7"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetdma__parallel.html#af9df427633cb9dc93aae24114abf95d7">cr_backward_multiple_row</a></td></tr>
<tr class="memdesc:af9df427633cb9dc93aae24114abf95d7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Backward substitution of CR after single-row solution per MPI process is obtained.  <a href="#af9df427633cb9dc93aae24114abf95d7">More...</a><br /></td></tr>
<tr class="separator:af9df427633cb9dc93aae24114abf95d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a33fc3b14caafcdd849e1d4c08e766695"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetdma__parallel.html#a33fc3b14caafcdd849e1d4c08e766695">cr_forward_single_row</a></td></tr>
<tr class="memdesc:a33fc3b14caafcdd849e1d4c08e766695"><td class="mdescLeft">&#160;</td><td class="mdescRight">Forward elimination of CR between a single row per MPI process.  <a href="#a33fc3b14caafcdd849e1d4c08e766695">More...</a><br /></td></tr>
<tr class="separator:a33fc3b14caafcdd849e1d4c08e766695"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a463b29782692ccfe72b867d5a4b7f2f2"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetdma__parallel.html#a463b29782692ccfe72b867d5a4b7f2f2">cr_backward_single_row</a></td></tr>
<tr class="memdesc:a463b29782692ccfe72b867d5a4b7f2f2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Backward substitution of CR until every MPI process gets solution for its single row.  <a href="#a463b29782692ccfe72b867d5a4b7f2f2">More...</a><br /></td></tr>
<tr class="separator:a463b29782692ccfe72b867d5a4b7f2f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf75cee6f05e371d59e0d40cb5138192"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetdma__parallel.html#aaf75cee6f05e371d59e0d40cb5138192">pcr_forward_single_row</a></td></tr>
<tr class="memdesc:aaf75cee6f05e371d59e0d40cb5138192"><td class="mdescLeft">&#160;</td><td class="mdescRight">PCR between a single row per MPI process and 2x2 matrix solver between i and i+nprocs/2 rows.  <a href="#aaf75cee6f05e371d59e0d40cb5138192">More...</a><br /></td></tr>
<tr class="separator:aaf75cee6f05e371d59e0d40cb5138192"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a15527e0932190d7abd8b716641de36e8"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetdma__parallel.html#a15527e0932190d7abd8b716641de36e8">pthomas_forward_multiple_row</a></td></tr>
<tr class="memdesc:a15527e0932190d7abd8b716641de36e8"><td class="mdescLeft">&#160;</td><td class="mdescRight">First phase of hybrid Thomas and PCR algorithm.  <a href="#a15527e0932190d7abd8b716641de36e8">More...</a><br /></td></tr>
<tr class="separator:a15527e0932190d7abd8b716641de36e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a438b27a63218775dcccdc41dcb7a6a36"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetdma__parallel.html#a438b27a63218775dcccdc41dcb7a6a36">pcr_double_row_substitution</a></td></tr>
<tr class="memdesc:a438b27a63218775dcccdc41dcb7a6a36"><td class="mdescLeft">&#160;</td><td class="mdescRight">PCR solver for two equations per each MPI process.  <a href="#a438b27a63218775dcccdc41dcb7a6a36">More...</a><br /></td></tr>
<tr class="separator:a438b27a63218775dcccdc41dcb7a6a36"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c627d634cb17863dd5ab60b3f4f8d11"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetdma__parallel.html#a9c627d634cb17863dd5ab60b3f4f8d11">verify_solution</a> (a_ver, b_ver, c_ver, r_ver, x_sol)</td></tr>
<tr class="memdesc:a9c627d634cb17863dd5ab60b3f4f8d11"><td class="mdescLeft">&#160;</td><td class="mdescRight">Solution check.  <a href="#a9c627d634cb17863dd5ab60b3f4f8d11">More...</a><br /></td></tr>
<tr class="separator:a9c627d634cb17863dd5ab60b3f4f8d11"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Parallel tri-diagonal matrix solver using cyclic reduction (CR), parallel CR (PCR), and Thomas+PCR hybrid algorithm. </p>
<p>The CR algorithm is described on Parallel Scientific Computing in C++ and MPI by Karniadakis and Kirby. CR algorithm removes odd rows recursively, so MPI processes begin to drop out after single row is left per MPI process, while PCR can use full parallelism. Therefore, PCR is a good solution from the level where single row is left per MPI process. In this implementation, we can choose CR or PCR algorithm from the single-row level. Odd-rows are removed successively and we obtain two reduced equations finally. Obtained solutions from 2x2 matrix equations are used to obtain other unknowns. Hybrid Thomas-PCR algorithm is from the work of Laszlo, Gilles and Appleyard, Manycore Algorithms for Batch Scalar and Block Tridiagonal Solvers, ACM TOMS, 42, 31 (2016).</p>
<dl class="section author"><dt>Author</dt><dd>Ji-Hoon Kang (<a href="#" onclick="location.href='mai'+'lto:'+'jhk'+'an'+'g@k'+'is'+'ti.'+'re'+'.kr'; return false;">jhkan<span style="display: none;">.nosp@m.</span>g@ki<span style="display: none;">.nosp@m.</span>sti.r<span style="display: none;">.nosp@m.</span>e.kr</a>), Korea Institute of Science and Technology Information </dd></dl>
<dl class="section date"><dt>Date</dt><dd>20 January 2019 </dd></dl>
<dl class="section version"><dt>Version</dt><dd>0.1 </dd></dl>
<dl class="section user"><dt>Copyright</dt><dd>Copyright (c) 2018 by Ji-Hoon Kang. All rights reserved. </dd></dl>
<dl class="section user"><dt>License </dt><dd></dd></dl>
<p>This project is release under the terms of the MIT License (see LICENSE in ) </p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="af9df427633cb9dc93aae24114abf95d7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af9df427633cb9dc93aae24114abf95d7">&#9670;&nbsp;</a></span>cr_backward_multiple_row()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine tdma_parallel::cr_backward_multiple_row </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Backward substitution of CR after single-row solution per MPI process is obtained. </p>

</div>
</div>
<a id="a463b29782692ccfe72b867d5a4b7f2f2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a463b29782692ccfe72b867d5a4b7f2f2">&#9670;&nbsp;</a></span>cr_backward_single_row()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine tdma_parallel::cr_backward_single_row </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Backward substitution of CR until every MPI process gets solution for its single row. </p>

</div>
</div>
<a id="afc500f1450d23091f136330208ca4519"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc500f1450d23091f136330208ca4519">&#9670;&nbsp;</a></span>cr_forward_multiple_row()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine tdma_parallel::cr_forward_multiple_row </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Forward elimination of CR until a single row per MPI process remains. </p>
<p>After a single row per MPI process remains, PCR or CR between a single row is performed. </p>

</div>
</div>
<a id="a33fc3b14caafcdd849e1d4c08e766695"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a33fc3b14caafcdd849e1d4c08e766695">&#9670;&nbsp;</a></span>cr_forward_single_row()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine tdma_parallel::cr_forward_single_row </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Forward elimination of CR between a single row per MPI process. </p>

</div>
</div>
<a id="a5b221ee60f9b10b484cd5439f5b485f0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5b221ee60f9b10b484cd5439f5b485f0">&#9670;&nbsp;</a></span>cr_pcr_solver()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine tdma_parallel::cr_pcr_solver </td>
          <td>(</td>
          <td class="paramtype">real(8), dimension(0:n_mpi+1), intent(inout), target&#160;</td>
          <td class="paramname"><em>a_mpi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8), dimension(0:n_mpi+1), intent(inout), target&#160;</td>
          <td class="paramname"><em>b_mpi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8), dimension(0:n_mpi+1), intent(inout), target&#160;</td>
          <td class="paramname"><em>c_mpi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8), dimension(0:n_mpi+1), intent(inout), target&#160;</td>
          <td class="paramname"><em>r_mpi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8), dimension(0:n_mpi+1), intent(inout), target&#160;</td>
          <td class="paramname"><em>x_mpi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>CR-PCR solver: cr_forward_multiple + pcr_forward_single + cr_backward_multiple. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">a_mpi</td><td>(input) Lower off-diagonal coeff., which is assigned to local private pointer a </td></tr>
    <tr><td class="paramname">b_mpi</td><td>(input) Diagonal coeff., which is assigned to local private pointer b </td></tr>
    <tr><td class="paramname">c_mpi</td><td>(input) Upper off-diagonal coeff.,, which is assigned to local private pointer c </td></tr>
    <tr><td class="paramname">r_mpi</td><td>(input) RHS vector, which is assigned to local private pointer r </td></tr>
    <tr><td class="paramname">x_mpi</td><td>(output) Solution vector, which is assigned to local private pointer x </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="abfb0b9e0d8e67acbd6d8cfa390faee6a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abfb0b9e0d8e67acbd6d8cfa390faee6a">&#9670;&nbsp;</a></span>cr_solver()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine tdma_parallel::cr_solver </td>
          <td>(</td>
          <td class="paramtype">real(8), dimension(0:n_mpi+1), intent(inout), target&#160;</td>
          <td class="paramname"><em>a_mpi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8), dimension(0:n_mpi+1), intent(inout), target&#160;</td>
          <td class="paramname"><em>b_mpi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8), dimension(0:n_mpi+1), intent(inout), target&#160;</td>
          <td class="paramname"><em>c_mpi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8), dimension(0:n_mpi+1), intent(inout), target&#160;</td>
          <td class="paramname"><em>r_mpi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8), dimension(0:n_mpi+1), intent(inout), target&#160;</td>
          <td class="paramname"><em>x_mpi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>CR solver: cr_forward_multiple + cr_forward_single + cr_backward_single + cr_backward_multiple. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">a_mpi</td><td>(input) Lower off-diagonal coeff., which is assigned to local private pointer a </td></tr>
    <tr><td class="paramname">b_mpi</td><td>(input) Diagonal coeff., which is assigned to local private pointer b </td></tr>
    <tr><td class="paramname">c_mpi</td><td>(input) Upper off-diagonal coeff.,, which is assigned to local private pointer c </td></tr>
    <tr><td class="paramname">r_mpi</td><td>(input) RHS vector, which is assigned to local private pointer r </td></tr>
    <tr><td class="paramname">x_mpi</td><td>(output) Solution vector, which is assigned to local private pointer x </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a438b27a63218775dcccdc41dcb7a6a36"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a438b27a63218775dcccdc41dcb7a6a36">&#9670;&nbsp;</a></span>pcr_double_row_substitution()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine tdma_parallel::pcr_double_row_substitution </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>PCR solver for two equations per each MPI process. </p>
<p>Forward CR to remain a single equation per each MPI process. PCR solver for single row is, then, executed. Substitution is also performed to obtain every solution. </p>

</div>
</div>
<a id="aaf75cee6f05e371d59e0d40cb5138192"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaf75cee6f05e371d59e0d40cb5138192">&#9670;&nbsp;</a></span>pcr_forward_single_row()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine tdma_parallel::pcr_forward_single_row </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>PCR between a single row per MPI process and 2x2 matrix solver between i and i+nprocs/2 rows. </p>

</div>
</div>
<a id="a15527e0932190d7abd8b716641de36e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a15527e0932190d7abd8b716641de36e8">&#9670;&nbsp;</a></span>pthomas_forward_multiple_row()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine tdma_parallel::pthomas_forward_multiple_row </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>First phase of hybrid Thomas and PCR algorithm. </p>
<p>Forward and backward elimination to remain two equations of first and last rows for each MPI processes </p>

</div>
</div>
<a id="a7aa2a590feb83632170b7cb7b74fefd3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7aa2a590feb83632170b7cb7b74fefd3">&#9670;&nbsp;</a></span>tdma_setup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine tdma_parallel::tdma_setup </td>
          <td>(</td>
          <td class="paramtype">integer(4), intent(in)&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(4), intent(in)&#160;</td>
          <td class="paramname"><em>np_world</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(4), intent(in)&#160;</td>
          <td class="paramname"><em>rank_world</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize local private variables from global input parameters. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">n</td><td>Size of global array </td></tr>
    <tr><td class="paramname">np_world</td><td>Number of MPI process </td></tr>
    <tr><td class="paramname">rank_world</td><td>rank ID in MPI_COMM_WORLD </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a03041ff2dce526db1fed51ab87b84da5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a03041ff2dce526db1fed51ab87b84da5">&#9670;&nbsp;</a></span>thomas_pcr_solver()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine tdma_parallel::thomas_pcr_solver </td>
          <td>(</td>
          <td class="paramtype">real(8), dimension(0:n_mpi+1), intent(inout), target&#160;</td>
          <td class="paramname"><em>a_mpi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8), dimension(0:n_mpi+1), intent(inout), target&#160;</td>
          <td class="paramname"><em>b_mpi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8), dimension(0:n_mpi+1), intent(inout), target&#160;</td>
          <td class="paramname"><em>c_mpi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8), dimension(0:n_mpi+1), intent(inout), target&#160;</td>
          <td class="paramname"><em>r_mpi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8), dimension(0:n_mpi+1), intent(inout), target&#160;</td>
          <td class="paramname"><em>x_mpi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Thomas-PCR solver: pThomas_forward_multiple + pcr_forward_double + pThomas_backward_multiple. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">a_mpi</td><td>(input) Lower off-diagonal coeff., which is assigned to local private pointer a </td></tr>
    <tr><td class="paramname">b_mpi</td><td>(input) Diagonal coeff., which is assigned to local private pointer b </td></tr>
    <tr><td class="paramname">c_mpi</td><td>(input) Upper off-diagonal coeff.,, which is assigned to local private pointer c </td></tr>
    <tr><td class="paramname">r_mpi</td><td>(input) RHS vector, which is assigned to local private pointer r </td></tr>
    <tr><td class="paramname">x_mpi</td><td>(output) Solution vector, which is assigned to local private pointer x </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a9c627d634cb17863dd5ab60b3f4f8d11"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9c627d634cb17863dd5ab60b3f4f8d11">&#9670;&nbsp;</a></span>verify_solution()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine tdma_parallel::verify_solution </td>
          <td>(</td>
          <td class="paramtype">real(8), dimension(0:n_mpi+1), intent(inout), target&#160;</td>
          <td class="paramname"><em>a_ver</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8), dimension(0:n_mpi+1), intent(inout), target&#160;</td>
          <td class="paramname"><em>b_ver</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8), dimension(0:n_mpi+1), intent(inout), target&#160;</td>
          <td class="paramname"><em>c_ver</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8), dimension(0:n_mpi+1), intent(inout), target&#160;</td>
          <td class="paramname"><em>r_ver</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(8), dimension(0:n_mpi+1), intent(inout), target&#160;</td>
          <td class="paramname"><em>x_sol</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Solution check. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">*a_ver</td><td>Coefficients of a with original values </td></tr>
    <tr><td class="paramname">*b_ver</td><td>Coefficients of b with original values </td></tr>
    <tr><td class="paramname">*c_ver</td><td>Coefficients of c with original values </td></tr>
    <tr><td class="paramname">*r_ver</td><td>RHS vector with original values </td></tr>
    <tr><td class="paramname">*x_sol</td><td>Solution vector </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.15
</small></address>
</body>
</html>
